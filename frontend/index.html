<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraform Cost Estimation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- SECTION A: HERO / SUMMARY -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Estimated Monthly Cost</h1>
                <div class="cost-display">
                    <span id="total-cost" class="cost-amount">$0.00</span>
                    <span class="estimate-badge">Assumption-based estimate</span>
                </div>
                <p class="hero-subtext">
                    Based on your infrastructure configuration and pricing assumptions
                </p>
                <div class="hero-actions">
                    <div class="export-controls">
                        <button id="export-btn" class="export-button" aria-label="Export estimate">
                            <span class="export-icon">ðŸ“¥</span>
                            <span class="export-label">Export</span>
                            <span class="export-arrow">â–¼</span>
                        </button>
                        <div id="export-dropdown" class="export-dropdown" style="display: none;">
                            <button id="export-csv-btn" class="export-option">
                                <span class="export-option-icon">ðŸ“Š</span>
                                Export CSV
                            </button>
                            <button id="export-pdf-btn" class="export-option">
                                <span class="export-option-icon">ðŸ“„</span>
                                Export PDF
                            </button>
                        </div>
                    </div>
                </div>
                <div class="hero-meta">
                    <div class="region-container">
                        <div class="region-pill" id="region-pill">
                            <span class="region-label">Region:</span>
                            <span id="region" class="region-value">-</span>
                            <span class="region-chevron">â–¼</span>
                        </div>
                        <div id="region-dropdown" class="region-dropdown" style="display: none;">
                            <div class="region-dropdown-header">Compare with region:</div>
                            <div class="region-options" id="region-options">
                                <!-- Region options rendered here -->
                            </div>
                            <button id="compare-region-btn" class="compare-button" style="display: none;">
                                Compare with <span id="selected-region-name"></span>
                            </button>
                        </div>
                    </div>
                    <div class="traffic-assumptions">
                        <label for="users-input" class="traffic-label">Traffic Assumptions (Optional)</label>
                        <input 
                            type="number" 
                            id="users-input" 
                            name="users-input" 
                            placeholder="Average users/month"
                            min="0"
                            class="traffic-input"
                        />
                        <span class="traffic-helper">Only affects request-based services when applicable</span>
                    </div>
                    <div class="coverage-badges" id="coverage-badges">
                        <!-- Coverage badges rendered here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- SCENARIO RESULT BANNER -->
        <section id="scenario-banner" class="scenario-banner" style="display: none;">
            <div class="scenario-banner-content">
                <div class="scenario-banner-header">
                    <span class="scenario-label">Scenario Active</span>
                    <button id="reset-scenario-btn" class="reset-button">Reset to Base Estimate</button>
                </div>
                <div class="scenario-assumptions" id="scenario-assumptions">
                    <!-- Scenario assumptions rendered here -->
                </div>
            </div>
        </section>

        <!-- SECTION B: COST DRIVERS -->
        <section class="cost-drivers-section">
            <h2 class="section-title">Where Your Costs Go</h2>
            <p class="section-description">Click a category to see detailed breakdown</p>
            <div id="cost-drivers" class="cost-drivers-grid">
                <!-- Cost driver cards rendered here -->
            </div>
        </section>

        <!-- SECTION C: DETAILED BREAKDOWN (Expandable) -->
        <section class="breakdown-section">
            <div class="breakdown-header">
                <h2 class="section-title">Detailed Breakdown</h2>
                <button id="toggle-breakdown" class="expand-button" aria-expanded="false">
                    <span class="button-text">Show Details</span>
                    <span class="button-icon">â–¼</span>
                </button>
            </div>
            <div id="breakdown-content" class="breakdown-content" style="display: none;">
                <div class="table-container">
                    <table id="cost-table" class="cost-table">
                        <thead>
                            <tr>
                                <th>Cloud</th>
                                <th>Service</th>
                                <th>Resource Name</th>
                                <th>Region</th>
                                <th class="cost-column">Monthly Cost (USD)</th>
                                <th>Confidence</th>
                                <th>Assumptions</th>
                            </tr>
                        </thead>
                        <tbody id="cost-table-body">
                            <!-- Table rows rendered here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Unpriced Resources -->
                <div id="unpriced-section" class="unpriced-section">
                    <h3 class="subsection-title">Unpriced / Missing Information</h3>
                    <p class="unpriced-notice">
                        <strong>Note:</strong> These resources are NOT included in the total cost estimate.
                    </p>
                    <div id="unpriced-resources" class="unpriced-list">
                        <!-- Unpriced resources rendered here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION D: SCENARIO COMPARISON -->
        <section id="scenario-comparison-section" class="scenario-comparison-section" style="display: none;">
            <h2 class="section-title">Scenario Comparison</h2>
            <div class="comparison-grid">
                <div class="comparison-card base-estimate">
                    <div class="comparison-card-header">
                        <span class="comparison-label">Base Estimate</span>
                        <span id="base-cost" class="comparison-cost">$0.00</span>
                    </div>
                    <div class="comparison-region" id="base-region">-</div>
                </div>
                <div class="comparison-card scenario-estimate">
                    <div class="comparison-card-header">
                        <span class="comparison-label">Scenario Estimate</span>
                        <span id="scenario-cost" class="comparison-cost">$0.00</span>
                    </div>
                    <div class="comparison-region" id="scenario-region">-</div>
                    <div id="scenario-delta" class="comparison-delta">
                        <!-- Delta displayed here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION E: INSIGHTS (Advisory Tone) -->
        <section class="insights-section">
            <h2 class="section-title">Cost Insights & Suggestions</h2>
            <p class="section-description">Advisory insights to help optimize your infrastructure costs</p>
            <div id="insights-container" class="insights-grid">
                <!-- Insight cards rendered here -->
            </div>
        </section>

        <!-- AI Key Input Section -->
        <section id="ai-key-section" class="ai-key-section">
            <h2 class="section-title">AI Configuration (Optional)</h2>
            <div class="ai-key-input-group">
                <label for="ai-api-key">AI API Key</label>
                <input 
                    type="password" 
                    id="ai-api-key" 
                    name="ai-api-key" 
                    placeholder="Enter your Mistral AI API key (optional)"
                    autocomplete="off"
                />
                <p class="ai-key-helper">
                    Use your own AI key to run analysis. Your key is never stored.
                </p>
            </div>
        </section>
    </div>

    <!-- EXPLAINER MODAL -->
    <div id="explainer-modal" class="explainer-modal" role="dialog" aria-labelledby="explainer-title" aria-modal="true" style="display: none;">
        <div class="explainer-modal-overlay"></div>
        <div class="explainer-modal-content">
            <div class="explainer-header">
                <h2 id="explainer-title" class="explainer-title">How This Estimate Works</h2>
                <button class="explainer-close" aria-label="Close explainer" id="explainer-close-btn">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="explainer-body">
                <div class="explainer-section">
                    <h3 class="explainer-section-title">What is this estimate?</h3>
                    <p class="explainer-section-content">
                        This is an estimate of your infrastructure's monthly cost,
                        based on configuration, assumptions, and public pricing data.
                        It helps you understand potential costs before deployment.
                    </p>
                </div>

                <div class="explainer-section">
                    <h3 class="explainer-section-title">How are costs calculated?</h3>
                    <p class="explainer-section-content">
                        Your Terraform configuration is analyzed to identify resources.
                        We use official cloud provider pricing APIs to look up current rates.
                        Region and instance specifications matterâ€”different locations have different prices.
                        For autoscaling resources, we use average instance counts, not peak usage.
                    </p>
                </div>

                <div class="explainer-section">
                    <h3 class="explainer-section-title">What assumptions are involved?</h3>
                    <p class="explainer-section-content">
                        Some values are inferred when not explicitly specified.
                        Autoscaling, usage patterns, and traffic levels are estimated based on typical workloads.
                        Confidence indicators show how certain we are about each cost item.
                        Uncertainty is normalâ€”real infrastructure costs vary with usage.
                    </p>
                </div>

                <div class="explainer-section">
                    <h3 class="explainer-section-title">What happens when I change a scenario?</h3>
                    <p class="explainer-section-content">
                        Your base estimate never changesâ€”it remains visible for comparison.
                        Scenarios show "what-if" comparisons side by side.
                        Deltas highlight the differences clearly with + or - indicators.
                        Nothing is applied automaticallyâ€”scenarios are exploratory only.
                    </p>
                </div>

                <div class="explainer-section">
                    <h3 class="explainer-section-title">What this is not</h3>
                    <p class="explainer-section-content">
                        This is <strong>not</strong> an official cloud provider bill.
                        It is <strong>not</strong> a commitment or binding estimate.
                        It is <strong>not</strong> an optimization tool that makes changes automatically.
                        Actual costs may vary based on real usage, discounts, and provider-specific factors.
                    </p>
                </div>

                <div class="explainer-section">
                    <h3 class="explainer-section-title">How should I use this?</h3>
                    <p class="explainer-section-content">
                        Use this for early planning and design decisions.
                        Compare scenarios to understand cost trade-offs.
                        Build cost awareness before deployment.
                        Share estimates with your team for informed discussions.
                    </p>
                </div>
            </div>
            <div class="explainer-footer">
                <button class="explainer-dismiss-btn" id="explainer-dismiss-btn">Got it</button>
            </div>
        </div>
    </div>

    <!-- SECTION E: FOOTER (Grounding) -->
    <footer class="disclaimer-footer">
        <p>
            This tool provides cost estimates based on infrastructure configuration,
            assumptions, and publicly available pricing information.
            It is NOT an official cloud provider bill.
            Actual costs may vary.
        </p>
        <p class="footer-learn-more">
            <a href="#" id="learn-more-link" class="learn-more-link">Learn more about how this estimate works</a>
        </p>
    </footer>

    <script src="app.js"></script>
</body>
</html>